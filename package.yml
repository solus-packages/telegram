name       : telegram
version    : 0.9.13
release    : 30
source     :
    - https://updates.tdesktop.com/tlinux/tsetup.0.9.13.tar.xz : d81a0160914f4f136bd79197688aeb0b9742a006cfd02c87097d24630b576e32
license    : GPL-3.0
summary    : Telegram is a messaging app with a focus on speed and security, it’s super fast, simple and free. 
description  : |
    Telegram is a messaging app with a focus on speed and security, it’s super fast, simple and free. 
builddeps    : wget
install      : |
    mkdir -p %installroot%/usr/bin
    mkdir -p %installroot%/usr/share/applications/
    mv Telegram %installroot%/usr/bin/telegram

    # Create icon directories
    mkdir -p %installroot%/usr/share/icons/hicolor/16x16/apps
    mkdir -p %installroot%/usr/share/icons/hicolor/32x32/apps
    mkdir -p %installroot%/usr/share/icons/hicolor/128x128/apps
    mkdir -p %installroot%/usr/share/icons/hicolor/256x256/apps
    mkdir -p %installroot%/usr/share/icons/hicolor/512x512/apps

    iconlist=(icon_16x16.png icon_32x32.png icon_128x128.png icon_256x256.png icon_512x512.png)

    # Fetch all icons

    for icon in "${iconlist[@]}"
    do
        wget https://raw.githubusercontent.com/telegramdesktop/tdesktop/master/Telegram/Telegram/Images.xcassets/Icon.iconset/$icon

        icondir=${icon/icon_/}
        icondir=${icondir/.png/}

        mv $icon %installroot%/usr/share/icons/hicolor/$icondir/apps/telegram.png
    done

    rm -f %installroot%/usr/share/applications/telegram.desktop
    
    # Desktop File
    DESKTOPFILE=%installroot%/usr/share/applications/telegram.desktop
    echo '[Desktop Entry]
    Encoding=UTF-8
    Version=1.0
    Type=Application
    Icon=telegram
    Exec=telegram
    Name=Telegram
    Comment=Telegram Client' >> $DESKTOPFILE
